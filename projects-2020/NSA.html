<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c6{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c4{color:inherit;text-decoration:inherit}.c5{font-style:italic}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c6"><p class="c0"><span class="c1">M Mason</span></p><p class="c0"><span class="c1">4/30/2019</span></p><p class="c0"><span class="c1">Final Project</span></p><p class="c0"><span class="c1">Dual Elliptic Curves and the NSA</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">It&rsquo;s been 6 years since the Snowden revelations, and at this point it&rsquo;s no surprise to anyone that the government has been spying on us. But given what we know about the hardness of breaking encryption with limited time/computational power, how did the NSA pull it off?</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Though the NSA used a &nbsp;number of tactics, the one we&rsquo;re going to focus on is its use of elliptic curve cryptography (Dual_EC_DRBG). It starts with three organizations--the NSA, RSA, and NIST. The NSA of course is the National Security Administration, an intelligence agency long involved in making and breaking codes. NIST is the National Institute of Standards and Technology, an agency within the Department of Commerce that, as the name suggests, sets standards for a variety of technology. RSA is a computer and network security company (no helpful acronym here-- the letters stand for the three founders&rsquo; names; they are also known for developing RSA encryption, a cryptosystem based on the factoring problem).</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">The story begins in 2006 when NIST released a document specifying standards for pseudorandom number generators. Much of cryptography depends on the ability to generate numbers that are as unpredictable as possible (have a high degree of entropy). NIST&rsquo;s standards listed four deterministic random bit generators (DRBGs)-- one based on hashing, one on HMAC, one on block ciphers, and one on elliptic curves. Yet while the first three were relatively fast and used something like symmetric key algorithms, the elliptic curve system stood out as looking more like a public key algorithm-- and was up to 1000 times slower than the others.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Dual_EC_DRBG essentially produces pseudorandom numbers by generating a series of points along an enormous curve in two stages and truncating the points to generate output. Rather than tracing the path of the curve, the points should appear to jump around. P is a point on the curve used for internal calculations, and Q is a corresponding point that spits out usable bits.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">It wasn&rsquo;t long before researchers began to notice something was up. In addition to being slow and different from the other standards, multiple groups began to publish papers pointing out flaws in Dual_EC_DRBG. First off, NIST had never actually done a security proof/reduction-- they just asserted that the algorithm worked, and used RSA&rsquo;s early adoption of it as a default (before Dual_EC_DRBG was even officially approved) to justify including it in their standards. An independent proof showed that due to the unusually large number of bits that Dual_EC_DRBG output per cycle (through point Q), the algorithm had a slight bias-- maybe not enough to make it unusable for practical purposes, but theoretically possible to brute force guess with a 0.1% chance of success. It was recommended that the algorithm be modified to put out fewer bits, but this change was never adopted in the final published standard. Then came a proof from a pair of Microsoft employees that showed that Dual_EC_DRBG contained a potential backdoor.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">It has to do with the points P and Q. NIST never explained where they got the default values for P and Q. For Dual_EC_DRBG to be secure, there should be no (known) constant relationship between P and Q. While points on the same curve by nature do have some kind of relationship, the values used were so large that it would be virtually impossible to calculate this number given the values of P and Q. However the proof given by the Microsoft employees demonstrated that not only did there exist some number e such that e*Q = P, but that if an attacker could figure out some number d such that d*P = Q then they could derive e from that and therefore predict subsequent output bits given only 32 bits of encrypted data, rendering the whole system useless. Furthermore, though they could not determine what e was (it would take massive amounts of computational power to do so) and they couldn&rsquo;t prove that e was known, they proved that the creator could know e and have produced P and Q alongside e.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">After this criticism came out, NIST attempted to make up for the suspicious P and Q values by going back and adding instructions for selecting a different P and Q-- of course, they need to be chosen &ldquo;correctly&rdquo; in order for them to work. And it turned out that this was a red herring, as only the default P and Q values actually worked for the algorithm to be FIPS certified, and the modified algorithm was seemingly never used.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span>With the Snowden leaks, it was revealed that, of course, the NSA </span><span class="c5">did</span><span class="c1">&nbsp;know the value of e, and had made deals with NIST and RSA to push through an encryption standard with obvious flaws because it contained this backdoor.</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">So, did the NSA beat the encryption standards? Not really, they pretty much just cheated. They had the public adopt a standard that was never completely secure to begin with and thwarted attempts to make the algorithm more secure because these &ldquo;flaws&rdquo; were a feature, not a bug. Maybe the only redeeming quality about Dual_EC_DRBG was that nobody but the NSA managed to crack it.</span></p><hr style="page-break-before:always;display:none;"><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">Citations/Additional Reading:</span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/&amp;sa=D&amp;ust=1556657786085000">https://blog.cryptographyengineering.com/2013/09/18/the-many-flaws-of-dualecdrbg/</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.reuters.com/article/us-usa-security-rsa/exclusive-secret-contract-tied-nsa-and-security-industry-pioneer-idUSBRE9BJ1C220131220&amp;sa=D&amp;ust=1556657786085000">https://www.reuters.com/article/us-usa-security-rsa/exclusive-secret-contract-tied-nsa-and-security-industry-pioneer-idUSBRE9BJ1C220131220</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.schneier.com/essays/archives/2007/11/did_nsa_put_a_secret.html&amp;sa=D&amp;ust=1556657786086000">https://www.schneier.com/essays/archives/2007/11/did_nsa_put_a_secret.html</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.propublica.org/article/the-nsas-secret-campaign-to-crack-undermine-internet-encryption&amp;sa=D&amp;ust=1556657786086000">https://www.propublica.org/article/the-nsas-secret-campaign-to-crack-undermine-internet-encryption</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.grahamcluley.com/nsa-cheated-cryptography/&amp;sa=D&amp;ust=1556657786086000">https://www.grahamcluley.com/nsa-cheated-cryptography/</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-90a.pdf&amp;sa=D&amp;ust=1556657786087000">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-90a.pdf</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.wired.com/2007/11/securitymatters-1115/&amp;sa=D&amp;ust=1556657786087000">https://www.wired.com/2007/11/securitymatters-1115/</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://www.isaca.org/Journal/archives/2016/volume-3/Pages/can-elliptic-curve-cryptography-be-trusted.aspx&amp;sa=D&amp;ust=1556657786087000">https://www.isaca.org/Journal/archives/2016/volume-3/Pages/can-elliptic-curve-cryptography-be-trusted.aspx</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://eprint.iacr.org/2006/190.pdf&amp;sa=D&amp;ust=1556657786088000">https://eprint.iacr.org/2006/190.pdf</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://eprint.iacr.org/2007/048.pdf&amp;sa=D&amp;ust=1556657786088000">https://eprint.iacr.org/2007/048.pdf</a></span></p><p class="c0"><span class="c3"><a class="c4" href="https://www.google.com/url?q=https://blog.0xbadc0de.be/archives/155&amp;sa=D&amp;ust=1556657786088000">https://blog.0xbadc0de.be/archives/155</a></span></p></body></html>