<html>
<head>
<TITLE>Candy Crush</TITLE>


<style type="text/css">
* {
    box-sizing: border-box;
}

/* Add a blue background color with some padding */
body {
    font-family: Arial;
    padding: 20px;
    background: #b3d9ff;
}

/* Header/Blog Title */
.header {
    padding: 10px;
    font-size: 40px;
    text-align: center;
    background: white;
}

/* Create two unequal columns that floats next to each other */
/* Left column */
.leftcolumn {   
    float: left;
    width: 75%;
}

/* Right column */
.rightcolumn {
    float: left;
    width: 25%;
    padding-left: 20px;
}

/* Fake image */
.fakeimg {
    background-color: #ddd;
    width: 100%;
    padding: 20px;
}

/* Add a card effect for articles */
.card {
     background-color: white;
     padding: 20px;
     margin-top: 20px;
}

/* Clear floats after the columns */
.row:after {
    content: "";
    display: table;
    clear: both;
}

/* Footer */
.footer {
    padding: 20px;
    text-align: center;
    background: #aaa;
    margin-top: 20px;
}

a:link {
    color: blue; 
    background-color: transparent;
    text-decoration: none;
    /*text-decoration: underline;*/
}

a:visited {
    color: blue;
    background-color: transparent;
    text-decoration: none;
    /*text-decoration: underline;*/
}

a:hover {
    color: red;
    background-color: transparent;
    text-decoration: none;
   /*text-decoration: underline;*/
}

a:active {
    color: blue;
    background-color: transparent;
    text-decoration: none;
    /*text-decoration: underline;*/
}

over {
    text-decoration: overline;
}


table, th, td {
    border: 1px solid black;
    border-collapse: collapse;
}


/* Responsive layout - when the screen is less than 800px wide, make the two columns stack on top of each other instead of next to each other */
@media screen and (max-width: 970px) {
    .leftcolumn, .rightcolumn {   
        width: 100%;
        padding: 0;
    }
}


</style>

<script language="JavaScript" type="text/javascript">
</script>



</body>
<div class="header">
  <h4>Candy Crush is NP-hard (Written by Toby Walsh, 2014)</h4>
  <h6>Presented by Qiaomei Li, Jiamin Li, and Emmely Rogers</h6>
</div>

<div class="row">
  <div class="leftcolumn">
  	
    <div class="card">
      <h2>The CANDY-CRUSH Problem</h2>
      
      <div class="fakeimg" style="height:440px;"><figure><center>
          <img src="candycrush.gif" style="width:395px;height:272px;">
        </center></figure>
      <p>Given an <b><i> a</i></b> by <b><i> b </i></b> board filled with one of six coloured candies, a number <b><i> k </i></b> of swaps, and a score <b><i> s </i></b> (# of chains of 3 identical candies deleted) to be achieved or beaten… Is there a sequence of <b><i> k </i></b> swaps which obtains a score of <b><i> s </i></b> or more? </p> 
      Note: If multiple chains are formed simultaneously, then chains are deleted from the bottom of the board to the top as they appear, and the candies above immediately drop down.
    </div>
    </div>
    <div class="card">
      <h2>CANDY-CRUSH &#8712 NP</h2>
      
      <div class="fakeimg" style="height:260px;">To prove the CANDY-CRUSH Problem is in NP, we use space complexity instead of time complexity. The space complexity is a measure of the amount of working storage the algorithm needs, and the time complexity is a measure of the running time corresponding to the size of the input. First, we will present an example which shows the difference between space complexity and time complexity. Given a problem which creates a new string by appending a list of words, the time complexity is <i>O(n)</i> where <i>n</i> is the number of nodes. Then the space complexity is <i>O(n&#8727m)</i>,where <i>m</i> is the length of the largest string. <br> <br>

        In the CANDY-CRUSH Problem, a witness is the sequence of <b><i> k </i></b> swaps that results in a score of <b><i> s </i></b> or more deletions of chains. The space complexity to specify the <b><i> a</i></b> by <b><i> b </i></b> board is <i>O(ab)</i> bits. The space complexity to specify the <b><i> k </i></b> swaps is <i>O(log(k))</i> bits. The space complexity to specify the score <b><i> s</i></b> is <i>O(log(s))</i> bits.
      The input with the largest space complexity is the <b><i> a</i></b> by <b><i> b </i></b> board. Since we use the coordinates of the board to identify each swap (note that each square of the board has 1 coordinate), <i>O(k&#8727log(a&#8727b))</i> bits are required. <i>O(k&#8727log(a&#8727b))</i> is less than the square of the input, so this problem is in NP.
      </div>
      
    </div>
    <div class="card">
      <h2>3SAT &#8804<sub>P</sub> CANDY-CRUSH</h2>
      
      <div class="fakeimg" style="height:320px;"><font size="4"><b>The Candies</b></font>
      <center>Using: <br><br><table style="width:25%">
        <tr>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="green.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="purple.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  <tr>
      </table>
      <br> <br>

      <center>Not Using: <br> <br><table style="width:25%">
        <tr>
    <td><center>
          <img src="blue.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="stripes.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="wrapper.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="color.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  <tr>
      </table>
      
      <p align="left">Will only form chains of 3 purple candies.</p>
      </div>
      <br>
      <div class="fakeimg" style="height:520px;"><font size="4"><b>Neutral Background</b></font>

  <center><table style="width:25%">
  <tr>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  <tr>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="green.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="green.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  </tr>
  <tr>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  </tr>



  <tr>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="green.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="green.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="orange.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  </tr>

  <tr>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="yellow.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
    <td><center>
          <img src="red.png" style="width:58.5px;height:58.5px;">
        </center></td></td>
  </tr>
</table></center>




        <ul>
          <li> Even columns have alternating rows of red and orange candies; odd columns have alternating rows of yellow and green candies as shown above. </li><br> 
      <li>Gadgets composed of purple candies will be introduced into the neutral background (see "The Gadgets" section below for more information).</li><br>

        <li>The board is unbounded in width and height; only a sample of the background is shown above.</li>
        
    </ul>
      </div>

      <br>
      <div class="fakeimg" style="height:997px;"><font size="4"><b>The Gadgets (Click on links to see images)</b></font> <br><br>
              Variable Gadget: Set by the user to make a variable true or false. 
      <ul><li>
      <div> <a href="variableTrue.png"><u>Variable Gadget (True)</u></a></div><br></li>
      <li><div> <a href="variableFalse.png"><u>Variable Gadget (False)</u></a></div><br>
      </li></ul>
      Connector Gadget: Connects a wire to the columns above the variable gadget.
      <ul><li>
      <div> <a href="connectorX.png"><u>Connector Gadget for x</u><sub>i</sub></a></div><br></li>
      <li><div> <a href="connectorXBAR.png"><u>Connector Gadget for <over>x</over></u><sub>i</sub></a></div><br></li>
      <li><div> Examples of how the Variable and Connector Gadget work together: </div><br>
        <ul>
        <li><div><a href="variableConnector.png"><u>Example if x</u><sub>i</sub><u> is true</u></a> <br> - purple candy appears at the Connector Gadget's output</div><br></li>
        <li><div><a href="variableConnectorFalse.png"><u>Example if x</u><sub>i</sub><u> is false</u></a><br> - purple candy doesn't appear at the Connector Gadget's output</div><br></li>
        <li><div><a href="variableConnectortrueXBAR.png"><u>Example if <over>x</over></u><sub>i</sub><u> is true</u></a><br> - purple candy doesn't appear at the Connector Gadget's output</div><br></li>
        <li><div><a href="variableConnectorfalseXBAR.png"><u>Example if <over>x</over></u><sub>i</sub><u> is false</u></a><br> - purple candy appears at the Connector Gadget's output</div></li>
      </ul>
      </ul>
      Wire Gadget: Used to transmit information across the board. If a purple candy is introduced at the input, then a purple candy will appear at the output (<a href="wireIO.png"><u>see figure</u></a>).
      <ul><li>
      <div> <a href="wire.png"><u>Wire Gadget</u></a></div><br></li>
      <li><div> <a href="variableConnectorWire.png"><u>Example of how the Variable, Connector, and Wire Gadget work together</u></a><br> - Connector Gadget's output is the Wire Gadget's input</div><br></li>
    </ul>
      Clause Gadget: The clause gadget is placed at the right-hand part of the board. Each clause has <i>m</i> Clause Gadgets. Clause Gadgets are arranged diagonally from top left to bottom right such that no two Clause Gadgets share any rows. Since each clause has 3 literals, we need 6 signals (including their negations) which are represented by 6 wire inputs. These wire inputs are connected to 1 clause gadget. We view each clause gadget in 2 parts: top half and bottom half (the construction of each part is shown below). Note that the maximum length of a wire is <i><b>a</b></i>, less than <i><b>a</b></i> chains are formed by setting a wire. 
      <ul><li><div> <a href="clauseTopHalf.png"><u>Clause Gadget (Top Half)</u></a><br>
        - has <i> ma</i> copies in total </div><br></li>
        <li><div> <a href="clauseBottomHalf.png"><u>Clause Gadget (Bottom Half)</u></a> <br> - Note: the figure shows the bottom half of the Clause Gadget for 1 clause, e.g. (x<sub>q</sub> &#8897 x<sub>r</sub> &#8897 x<sub>s</sub>)</div><br></li>
        <li><div><a href="allGadgets.png"><u>Example of how the Variable, Connector, Wire, and Clause Gadget work together</u></a></div></li>
    </ul>
      </div>

      <ul>
      <li><p>3SAT = {&#966 |&#966 is a satisfiable Boolean formula in 3CNF}</p></li>
      <p>3CNF (an “AND” of three “ORs”): (x<sub>1</sub> &#8897 x<sub>2</sub> &#8897 x<sub>3</sub>) &#8896 ... &#8896 (x<sub>q</sub> &#8897 x<sub>r</sub> &#8897 x<sub>s</sub>)</p>
      <li>To show CANDY-CRUSH is NP-hard, the paper reduces an instance of 3SAT with <b><i>n</i></b> variables and <b><i>m</i></b> clauses to an instance of the Candy Crush problem.</li><br>
      <li>Set <b><i>k</i></b> = <b><i>n</i></b> (recall <b><i>k</i></b> is # of swaps).</li><br> 
      
      <li> Because of the way the infinite neutral background and gadgets are constructed, the only way to get the maximum achievable score is to set only variable gadgets such that all the clause gadgets are satisfied. </li><br>
      <li>So, deciding if we can achieve score <b><i>s</i></b> determines the satisfiability of the original 3SAT problem.</li><br>
      <li> The reduction is polynomial because the board created is <i>O(n+m<sup>2</sup>)</i> wide and <i>O(m<sup>3</sup>(n+m<sup>2</sup>))</i> high.
    </div>

    <div class="card"> <b>Team Member's Contributions</b> <br> <br>
      Qiaomei went to office hours to get our questions answered. Jiamin drew pictures on a white board to help us understand how the gadgets worked together. Emmely designed the blog and created gif files for the presentation. We all worked on the slides for our presentation together.

    </div>

  </div>
  <div class="rightcolumn">
    <div class="card">
      <h2>About Candy Crush</h2>
      <div><center> <figure><img src="logo.png" style="width:150px;height:150px;"></figure></center> </div>
      <ul>
      <li><p>A player has to achieve a given score with a fixed number of swaps</p></li>
      <li><p>A swap interchanges two neighbouring candies to create a chain of identical candies</p></li>
      <li><p>If chains are deleted from the board, then the candies above drop down into their place</p></li>
    </ul>
    </div>
<div class="card">
      <h2>The Main Takeaway</h2>
      
      Generalized versions of match 3 games (e.g. Bejeweled) are in NP and are NP-hard, thus they are NP-complete.<br> <br> 
      People spend millions of hours solving these games, and the creators profit from them! Perhaps we can use the above fact to build more games like Candy Crush that appear easy but are actually computationally difficult to solve.
      <br>
        <figure><center>
          <img src="hard.gif" style="width:220px;height:225px;">
        </center></figure>
        

</div>


    <div class="card">
      <h2>Our Evaluation</h2>
      <ul>
      <li><p>This problem uses a strict rule on columns, assuming the candies drop down vertically. However, in some levels of candy crush the candies need to move both vertically and horizontally to fill in the board due to blockers.</p>
        <div><img src="blockers.jpg" style="width:187.5px;height:203px;"></div><br>
      </li>
      <li><p>This problem doesn't account for all types of levels in candy crush. For example, in a timed level the player has an unconstrained # of moves</p>
        <div><img src="timed.gif" style="width:180px;height:262.857143px;"></div><br>
      </li>
      <li><p>This problem includes a clever use of gadgets to solve the reduction</p></li>
    </ul>
    </div>
    <div class="card">
      <h2>Why We Picked This Topic</h2>
      <ul>
      <li><p>It used a reduction to 3SAT which is something we learned about in class</p></li>
      <li><p>It is a well known game</p>
        <div><img src="devices.jpg" style="width:176.6666666667px;height:99.3333333333333px;"></div>
      </li></ul>
    </div>

    <div class="card">
      <h2>If You Love Candy Crush...</h2>
      <ul>
      <li><p>Have you watched any episodes of the Candy Crush TV Show on CBS?</p>
        <div><img src="tv.jpg" style="width:210px;height:140.2px;"></div><br>
      </li>
      <li><p>Have you tried playing the other sagas?</p>
        <div><img src="soda.png" style="width:100px;height:100px;">
          <img src="jelly.png" style="width:100px;height:100px;"></div><br>
      </li>
      <li><p>Have you eaten Candy Crush Gummies?</p>
        <div><img src="gummies.jpg" style="width:182.5px;height:121.75px;"></div>
      </li></ul>
    </div>
    <div class="card"> <center>
    <img src="quote2.jpg" style="width:280px;height:280px;"> </center>
  </div>

  </div>
</div>

<div class="footer">
  <h2><a href="https://arxiv.org/pdf/1403.1911.pdf"><u>Link to Original Paper</u></a> <br> <a href="https://candycrush.isnphard.com/"> <u>Link to Additional Reading: Another Proof that Candy Crush is NP-hard</u></a></h2>
</div><br>
<center>
<font size="2">Created for CSC250 - Theory of Computation (Spring 2018), taught by R. Jordan Crouser at Smith College</font></center>

</html>

